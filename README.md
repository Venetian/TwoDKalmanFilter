# TwoDKalmanFilter
Simple Kalman filter with no dependencies for tempo/phase or velocity/position tracking

It can be quite diufficult to find a simple Kalman Filter in C++ without recourse to large libraries like openCV. In Python, you can use pykalman.


Classes for Two-dimnesional Vector and 2x2 Matrix
A simple class does Kalman Filtering using:

model equations:
x_k = x_k-1 + v_k-1 + noise_x (covaraiance Q_x)
v_k = v_k-1 + noise_v (covaraiance Q_v)

given the estimates:
(x_0, v_0) initialises the model
then (x_n, v_n) results in new predictions from the filter.

You'll need to think about the correct covariance matrices for initialisation, Q, R and P_k

see for example:
http://bilgin.esme.org/BitsBytes/KalmanFilterforDummies.aspx


To run this, create a command line tool in Xcode or whichever IDE you use.





....
The output of the simple example, run as a command line tool is:
SIMPLE EXAMPLE FOR TEMPO AND PHASE PROCESSING WITH KALMAN FILTER!
TWO_D_KALMAN RE-INIT phase 0, tempo 500
TWO_D_KALMAN RE-INIT phase 2000, tempo 500
our estimate starts out at 2000ms position and 500 ms beat period
15.000000 0.000000
0.000000 9.000000

1.000000 0.000000
1.000000 1.000000

15.000000 0.000000
9.000000 9.000000

24.000000 9.000000
9.000000 9.000000

2500.000000
500.000000

Pk_hat
49.000000 9.000000
9.000000 9.800000

Pk_hat+R
149.000000 9.000000
9.000000 25.799999

denom inverse:
0.006856 -0.002392
-0.002392 0.039594

0.400000 0.000000
0.000000 0.400000

new kalman gain
0.314413 0.239158
0.038265 0.366497

new observation 2510.000000 and tempo 504.500000
estimate is:
2500.000000
500.000000

10.000000
4.500000

new kalman gain
0.314413 0.239158
0.038265 0.366497

diff
10.000000
4.500000

product
4.220345
2.031888

new estimate
2504.220459
502.031891

TWO_D estimate: 2504.22, tempo 502.032
Pk
15.000000 0.000000
0.000000 9.000000

Pk_hat
49.000000 9.000000
9.000000 9.800000

new kalman gain
0.314413 0.239158
0.038265 0.366497

0.685587 -0.239158
-0.038265 0.633503

updated Pk
31.441326 3.826531
3.826531 5.863945

31.441326 3.826531
3.826531 5.863945

1.000000 0.000000
1.000000 1.000000

35.267857 3.826531
9.690476 5.863945

44.958332 9.690476
9.690476 5.863945

3006.252197
502.031891

Pk_hat
69.958336 9.690476
9.690476 6.663946

Pk_hat+R
169.958328 9.690476
9.690476 22.663946

denom inverse:
0.006031 -0.002579
-0.002579 0.045225

0.314413 0.239158
0.038265 0.366497

new kalman gain
0.396918 0.257861
0.041258 0.276392

new observation 3021.000000 and tempo 513.000000
estimate is:
3006.252197
502.031891

14.747767
10.968112

new kalman gain
0.396918 0.257861
0.041258 0.276392

diff
14.747767
10.968112

product
8.681906
3.639961

new estimate
3014.934082
505.671844

TWO_D estimate: 3014.93, tempo 505.672
Pk
31.441326 3.826531
3.826531 5.863945

Pk_hat
69.958336 9.690476
9.690476 6.663946

new kalman gain
0.396918 0.257861
0.041258 0.276392

0.603082 -0.257861
-0.041258 0.723608

updated Pk
39.691807 4.125778
4.125778 4.422276

39.691807 4.125778
4.125778 4.422276

1.000000 0.000000
1.000000 1.000000

43.817585 4.125778
8.548054 4.422276

52.365639 8.548054
8.548054 4.422276

3520.605957
505.671844

Pk_hat
77.365639 8.548054
8.548054 5.222275

Pk_hat+R
177.365646 8.548054
8.548054 21.222275

denom inverse:
0.005750 -0.002316
-0.002316 0.048053

0.396918 0.257861
0.041258 0.276392

new kalman gain
0.425032 0.231590
0.037054 0.231150

new observation 3543.000000 and tempo 521.000000
estimate is:
3520.605957
505.671844

22.394012
15.328152

new kalman gain
0.425032 0.231590
0.037054 0.231150

diff
22.394012
15.328152

product
13.068006
4.372900

new estimate
3533.674072
510.044739

TWO_D estimate: 3533.67, tempo 510.045
Pk
39.691807 4.125778
4.125778 4.422276

Pk_hat
77.365639 8.548054
8.548054 5.222275

new kalman gain
0.425032 0.231590
0.037054 0.231150

0.574968 -0.231590
-0.037054 0.768850

updated Pk
42.503159 3.705436
3.705436 3.698403

42.503159 3.705436
3.705436 3.698403

1.000000 0.000000
1.000000 1.000000

46.208595 3.705436
7.403839 3.698403

53.612431 7.403839
7.403839 3.698403

4043.718750
510.044739

Pk_hat
78.612434 7.403839
7.403839 4.498403

Pk_hat+R
178.612427 7.403839
7.403839 20.498404

denom inverse:
0.005684 -0.002053
-0.002053 0.049526

0.425032 0.231590
0.037054 0.231150

new kalman gain
0.431619 0.205294
0.032847 0.207587

new observation 4045.000000 and tempo 507.000000
estimate is:
4043.718750
510.044739

1.281259
-3.044749

new kalman gain
0.431619 0.205294
0.032847 0.207587

diff
1.281259
-3.044749

product
-0.072054
-0.589966

new estimate
4043.646729
509.454773

TWO_D estimate: 4043.65, tempo 509.455
Pk
42.503159 3.705436
3.705436 3.698403

Pk_hat
78.612434 7.403839
7.403839 4.498403

new kalman gain
0.431619 0.205294
0.032847 0.207587

0.568381 -0.205294
-0.032847 0.792413

updated Pk
43.161869 3.284707
3.284707 3.321397

Program ended with exit code: 0